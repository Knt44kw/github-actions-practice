name: matrix demo
on: push
jobs:
  build:
    # 他のジョブが途中で失敗しても、workflow全体が正常終了するようにする
    continue-on-error: true
    strategy:
      # matrix: 変数を定義することで、変数の組み合わせに基づく複数のジョブ実行を自動的に作成できる。
      # 詳細: https://docs.github.com/ja/actions/using-jobs/using-a-matrix-for-your-jobs
      matrix:
        # 以下の組み合わせを総当りして並行に行う (key名は任意)
        # 例: node-version=12に対して、{ubuntu, windows}-latestにしたときのstepsを実行。node-version=14,16の時も同様
        # node-version = 12だと失敗する
        node-version: [12, 14, 16]
        os: [ubuntu-latest, windows-latest]
        # include, excludeは予約語。
        include:
          # matrixで指定した値から、新規追加する変数 (node-version=18, ubuntu-latestのジョブ実行を新規追加)
          - node-version: 18
            os: ubuntu-latest
        exclude:
          # matrixで指定した値のうち、ジョブ実行を省く変数の設定(=node-version=12, windows-latestのときのジョブ実行を省く)
          - node-version: 12
            os: windows-latest
    runs-on: ${{ matrix.os }}
    steps:
      - name: Get Code
        uses: actions/checkout@v3
      - name: Install NodeJS
        uses: actions/setup-node@v3
        with:
          node-version: ${{ matrix.node-version }}
      - name: Install Dependencies
        run: npm ci
      - name: Build project
        run: npm run build